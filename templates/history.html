{% extends 'base.html' %}

{% block title %}Patient History - Doctor App{% endblock %}

{% block content %}
<header class="page-header">
  <h1>ðŸ“œ Patient Consultation History</h1>
</header>

<div class="card">
  <div class="filter-container">
    <input type="text" placeholder="Search by patient name..." class="filter-search">
    <div class="filter-dates">
      <label for="startDate">From:</label>
      <input type="date" id="startDate" name="startDate">
      <label for="endDate">To:</label>
      <input type="date" id="endDate" name="endDate">
    </div>
    <button class="btn">Search</button>
  </div>

  <table class="history-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Patient Name</th>
        <th>Date</th>
        <th>Key Symptoms</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <!-- Loop through each prescription passed from the view -->
      {% for pres in prescriptions %}
      <tr>
        <td>#{{ pres.id }}</td>
        <td>{{ pres.patient.name }}</td>
        <td>{{ pres.date_created|date:"Y-m-d" }}</td>
        <td>
          <!-- Display a comma-separated list of symptoms -->
          {{ pres.symptoms.all|join:", " }}
        </td>
        <td><a href="#" class="btn btn-small">View Details</a></td>
      </tr>
      {% empty %}
      <!-- This message shows if there are no prescriptions in the database -->
      <tr>
        <td colspan="5" style="text-align: center; padding: 20px;">
          No patient history found. Start by creating a new prescription.
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Pagination can be added here later if needed -->
</div>
{% endblock %}
